Running SLURM prolog script on swarma1002
===============================================================================
Job started on Thu Nov 28 14:23:24 GMT 2024
Job ID          : 35576
Job name        : vitsmall_224_sigmoid
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/plrbitlinear/vitsmall_224_sigmoid.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 16
Num of tasks    : 1
Hosts allocated : swarma1002
Job Output Follows ...
===============================================================================
torch.Size([3, 322, 322])
torch.Size([3, 322, 322])
torch.Size([3, 224, 224])
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Teacher and student have the same descriptor dimension. No adaptation needed.
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
VPRModel(
  (backbone): ViT(
    (to_patch_embedding): Sequential(
      (0): Rearrange('b c (h p1) (w p2) -> b (h w) (p1 p2 c)', p1=14, p2=14)
      (1): LayerNorm((588,), eps=1e-05, elementwise_affine=True)
      (2): Linear(in_features=588, out_features=384, bias=True)
      (3): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (transformer): Transformer(
      (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x ModuleList(
          (0): Attention(
            (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attend): Softmax(dim=-1)
            (dropout): Dropout(p=0.1, inplace=False)
            (to_qkv): PLRBitLinear
            (to_out): Sequential(
              (0): PLRBitLinear
              (1): Dropout(p=0.1, inplace=False)
            )
          )
          (1): FeedForward(
            (net): Sequential(
              (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (1): PLRBitLinear
              (2): GELU(approximate='none')
              (3): Dropout(p=0.1, inplace=False)
              (4): PLRBitLinear
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
    )
  )
  (aggreagtion): SALAD(
    (token_features): Sequential(
      (0): Linear(in_features=384, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=256, bias=True)
    )
    (cluster_features): Sequential(
      (0): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1))
    )
    (score): Sequential(
      (0): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
    )
  )
)
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  |  8.3728 |
| Pitts30k_val_R5  | 22.1346 |
| Pitts30k_val_R10 | 32.8339 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 10.7781 |
| Pitts30k_val_R5  | 27.1556 |
| Pitts30k_val_R10 | 38.1966 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 14.2482 |
| Pitts30k_val_R5  | 33.2545 |
| Pitts30k_val_R10 | 45.1630 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 21.6483 |
| Pitts30k_val_R5  | 45.1104 |
| Pitts30k_val_R10 | 56.9138 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 35.3838 |
| Pitts30k_val_R5  | 59.9895 |
| Pitts30k_val_R10 | 70.1893 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 57.4001 |
| Pitts30k_val_R5  | 79.1404 |
| Pitts30k_val_R10 | 86.0542 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 68.6383 |
| Pitts30k_val_R5  | 86.7245 |
| Pitts30k_val_R10 | 91.2461 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 69.3481 |
| Pitts30k_val_R5  | 86.7508 |
| Pitts30k_val_R10 | 91.2461 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 71.6746 |
| Pitts30k_val_R5  | 88.7355 |
| Pitts30k_val_R10 | 92.4159 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 72.1083 |
| Pitts30k_val_R5  | 87.9863 |
| Pitts30k_val_R10 | 92.4159 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 76.4853 |
| Pitts30k_val_R5  | 90.8123 |
| Pitts30k_val_R10 | 94.1640 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 78.3912 |
| Pitts30k_val_R5  | 92.0610 |
| Pitts30k_val_R10 | 95.0315 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 80.6651 |
| Pitts30k_val_R5  | 92.9154 |
| Pitts30k_val_R10 | 95.5573 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 82.4527 |
| Pitts30k_val_R5  | 93.3097 |
| Pitts30k_val_R10 | 95.5967 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 81.7166 |
| Pitts30k_val_R5  | 93.1388 |
| Pitts30k_val_R10 | 95.4916 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 82.3212 |
| Pitts30k_val_R5  | 93.5463 |
| Pitts30k_val_R10 | 96.1882 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.8044 |
| Pitts30k_val_R5  | 94.9658 |
| Pitts30k_val_R10 | 96.7008 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.5536 |
| Pitts30k_val_R5  | 95.4916 |
| Pitts30k_val_R10 | 97.2397 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 84.7923 |
| Pitts30k_val_R5  | 94.5321 |
| Pitts30k_val_R10 | 96.5037 |
+------------------+---------+
Skipping corrupted image: 1263776
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 2421385
Skipping corrupted image: 3283479
Skipping corrupted image: 1357413
Skipping corrupted image: 1661876
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 723652
Skipping corrupted image: 3057859

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.0158 |
| Pitts30k_val_R5  | 94.6635 |
| Pitts30k_val_R10 | 96.5431 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 84.3323 |
| Pitts30k_val_R5  | 94.1640 |
| Pitts30k_val_R10 | 96.1882 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.5941 |
| Pitts30k_val_R5  | 95.1104 |
| Pitts30k_val_R10 | 96.7928 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.6730 |
| Pitts30k_val_R5  | 95.2156 |
| Pitts30k_val_R10 | 97.0820 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.5810 |
| Pitts30k_val_R5  | 94.9264 |
| Pitts30k_val_R10 | 97.0557 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.5284 |
| Pitts30k_val_R5  | 95.3076 |
| Pitts30k_val_R10 | 97.0426 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.6840 |
| Pitts30k_val_R5  | 96.0699 |
| Pitts30k_val_R10 | 97.5158 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.0258 |
| Pitts30k_val_R5  | 96.1488 |
| Pitts30k_val_R10 | 97.6078 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.9217 |
| Pitts30k_val_R5  | 95.9648 |
| Pitts30k_val_R10 | 97.3975 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.7245 |
| Pitts30k_val_R5  | 95.7545 |
| Pitts30k_val_R10 | 97.1477 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.7518 |
| Pitts30k_val_R5  | 95.0841 |
| Pitts30k_val_R10 | 96.9111 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.5263 |
| Pitts30k_val_R5  | 96.0174 |
| Pitts30k_val_R10 | 97.5289 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.0400 |
| Pitts30k_val_R5  | 95.8070 |
| Pitts30k_val_R10 | 97.3580 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.9469 |
| Pitts30k_val_R5  | 96.1356 |
| Pitts30k_val_R10 | 97.4632 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.1188 |
| Pitts30k_val_R5  | 95.7545 |
| Pitts30k_val_R10 | 97.2792 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.5273 |
| Pitts30k_val_R5  | 95.4390 |
| Pitts30k_val_R10 | 96.9243 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.1725 |
| Pitts30k_val_R5  | 95.7676 |
| Pitts30k_val_R10 | 97.2135 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.6709 |
| Pitts30k_val_R5  | 95.9648 |
| Pitts30k_val_R10 | 97.5289 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.5647 |
| Pitts30k_val_R5  | 96.2014 |
| Pitts30k_val_R10 | 97.7261 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.6062 |
| Pitts30k_val_R5  | 95.8596 |
| Pitts30k_val_R10 | 97.3975 |
+------------------+---------+
Skipping corrupted image: 1263776
Skipping corrupted image: 1357413
Skipping corrupted image: 3057859
Skipping corrupted image: 3283479
Skipping corrupted image: 723652
Skipping corrupted image: 2421385
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 1661876

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.7771 |
| Pitts30k_val_R5  | 95.5310 |
| Pitts30k_val_R10 | 97.3580 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.4090 |
| Pitts30k_val_R5  | 95.4259 |
| Pitts30k_val_R10 | 97.2792 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.6719 |
| Pitts30k_val_R5  | 95.4127 |
| Pitts30k_val_R10 | 97.1609 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.1188 |
| Pitts30k_val_R5  | 95.9253 |
| Pitts30k_val_R10 | 97.4895 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.2645 |
| Pitts30k_val_R5  | 95.4916 |
| Pitts30k_val_R10 | 97.4238 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.4627 |
| Pitts30k_val_R5  | 95.1630 |
| Pitts30k_val_R10 | 97.0426 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.3412 |
| Pitts30k_val_R5  | 96.2934 |
| Pitts30k_val_R10 | 97.6866 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.6972 |
| Pitts30k_val_R5  | 96.0962 |
| Pitts30k_val_R10 | 97.7129 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.1320 |
| Pitts30k_val_R5  | 95.7282 |
| Pitts30k_val_R10 | 97.3975 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.8822 |
| Pitts30k_val_R5  | 95.6887 |
| Pitts30k_val_R10 | 97.2135 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.3302 |
| Pitts30k_val_R5  | 95.7150 |
| Pitts30k_val_R10 | 97.3975 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.2897 |
| Pitts30k_val_R5  | 96.0699 |
| Pitts30k_val_R10 | 97.6866 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.7760 |
| Pitts30k_val_R5  | 96.0962 |
| Pitts30k_val_R10 | 97.5946 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.1057 |
| Pitts30k_val_R5  | 95.9911 |
| Pitts30k_val_R10 | 97.6472 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.7629 |
| Pitts30k_val_R5  | 96.1882 |
| Pitts30k_val_R10 | 97.4106 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.3423 |
| Pitts30k_val_R5  | 95.8070 |
| Pitts30k_val_R10 | 97.5026 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.9874 |
| Pitts30k_val_R5  | 95.6887 |
| Pitts30k_val_R10 | 97.5683 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.6435 |
| Pitts30k_val_R5  | 96.4642 |
| Pitts30k_val_R10 | 98.0152 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.7355 |
| Pitts30k_val_R5  | 96.3985 |
| Pitts30k_val_R10 | 98.0021 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.8943 |
| Pitts30k_val_R5  | 96.0831 |
| Pitts30k_val_R10 | 97.6341 |
+------------------+---------+
Skipping corrupted image: 3057859
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 3283479
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 723652
Skipping corrupted image: 1263776
Skipping corrupted image: 1357413
Skipping corrupted image: 2421385
Skipping corrupted image: 1661876

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.9732 |
| Pitts30k_val_R5  | 96.1356 |
| Pitts30k_val_R10 | 97.5552 |
+------------------+---------+
[1;34mwandb[0m: 🚀 View run [33mbackbone[vit_small_plrbitlinear]_agg[salad]_teacher[dinosalad]_res[224x224]_aug[severe]_decay[sigmoid][0m at: [34mhttps://wandb.ai/vpr_minds/distill/runs/tgfqbgj6[0m
==============================================================================
Running epilogue script on swarma1002.

Submit time  : 2024-11-28T11:43:01
Start time   : 2024-11-28T14:23:24
End time     : 2024-11-29T10:54:57
Elapsed time : 20:31:33 (Timelimit=2-11:00:00)

Job ID: 35576
Cluster: iridis_x
User/Group: oeg1n18/
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 3-09:29:35
CPU Efficiency: 24.81% of 13-16:24:48 core-walltime
Job Wall-clock time: 20:31:33
Memory Utilized: 165.21 GB
Memory Efficiency: 129.07% of 128.00 GB
