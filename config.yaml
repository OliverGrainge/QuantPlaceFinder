
Datasets:
  datasets_dir: "/mnt/datasets_drive/vpr_datasets"

  
  
  


Training:
  training_method: gsvcities
  monitor: 'pitts30k_val/R1'
  accelerator: 'gpu'
  precision: bf16-mixed
  batch_size: 128
  max_epochs: 150 # 30 for pretraining
  search_precision: 'float32'
  fast_dev_run: False
  val_set_names:
    - pitts30k_val
  num_workers: 4
  image_size:
    - 224
    - 224


  GSVCities: 
    shuffle_all: True
    optimizer: 'adamw' #adam
    lr: 0.0002
    weight_decay: 0.1
    momentum: 0.9
    warmup_steps: 1000 # 600
    milestones:
      - 30
      - 40
      - 50
      - 65
    lr_mult: 0.3
    loss_name: 'MultiSimilarityLoss'
    miner_name: 'MultiSimilarityMiner'
    miner_margin: 0.1
    faiss_gpu: False
    random_sample_from_each_place: True
    show_data_stats: True
    img_per_place: 4
    min_img_per_place: 4
    cities:
     - Bangkok
     - BuenosAires
     - LosAngeles
     - MexicoCity
     - OSL # refers to Oslo
     - Rome
     - Barcelona
     - Chicago
     - Madrid
     - Miami
     - Phoenix
     - TRT # refers to Toronto
     - Boston
     - Lisbon
     - Medellin
     - Minneapolis
     - PRG # refers to Prague
     - WashingtonDC
     - Brussels
     - London
     - Melbourne
     - Osaka
     - PRS # refers t
    

  EigenPlaces: 
    weight_decay: 0.01
    dataset_size: large
    lr: 0.00001 # 0.00001 for large dataset
    classifiers_lr: 0.01
    lambda_lat: 1.
    lambda_front: 1.
    iterations_per_epoch: 5000
    M: 15 
    N: 3
    s: 100
    m: 0.4
    focal_dist: 10
    min_images_per_class: 5
    visualize_classes: 0
    brightness: 0.7
    contrast: 0.7
    saturation: 0.7 
    hue: 0.5
    random_resized_crop: 0.5


Model:
  load_checkpoint: ""
  backbone_arch: 'resnet18'
  agg_arch: 'GeM'

  backbone_config: 
    resnet18: 
      model_name: 'resnet18'
      pretrained: True
      layers_to_freeze: 2
      layers_to_crop: 
        -
    resnet50: 
      model_name: 'resnet50'
      pretrained: True
      layers_to_freeze: 2
      layers_to_crop: 
        -
    efficientnet: 
      model_name: 'efficientnet_b0'
      pretrained: True
      layers_to_freeze: 4

    dinov2: 
      model_name: 'dinov2_vits14'
      num_trainable_blocks: 4
      norm_layer: True
      return_token: True

    swin: 
      model_name: 'swinv2_base_window12to16_192to256_22kft1k'
      pretrained: True 
      layers_to_freeze: 2

    vit: 
      pretrained: False
      layers_to_freeze: 0
      layers_to_truncate: 12

    mobilevit: 
        num_classes: 1024

    cct: 
      embedding_dim: 768
      num_layers: 14
      num_heads: 12
      mlp_ratio: 4.0

    
    

  agg_config:
    convap: 
      out_channels: 128
      s1: 2
      s2: 2
    gem: 
      out_dim: 1024
    mixvpr: 
      out_channels: 1024 
      mix_depth: 4
      mlp_ratio: 1
      out_rows: 4
    salad: 
      num_clusters: 64
      cluster_dim: 128
    cls: 



Quantize:
  qlinear: LinearW4A16
  qconv: Conv2dW4A8